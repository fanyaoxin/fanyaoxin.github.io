<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>python基础-pandas | Fan Yaoxin</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">python基础-pandas</h1><a id="logo" href="/.">Fan Yaoxin</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">python基础-pandas</h1><div class="post-meta">Nov 22, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h1 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h1><p>import pandas as pd</p>
<h2 id="1-two-main-data-strutures"><a href="#1-two-main-data-strutures" class="headerlink" title="1 two main data strutures"></a>1 two main data strutures</h2><h2 id="2-Series"><a href="#2-Series" class="headerlink" title="2 Series"></a>2 Series</h2><ul>
<li>one-dimensional array of data, and an sequence of labels called the index</li>
<li>the index can contain numeric, string, or date/time values.</li>
<li>when the index values is a time value, the series is a time series.</li>
<li>the index must be the same length as the data</li>
<li>if no index is suppiled then it is automotically generated as range(len(data))</li>
</ul>
<h3 id="2-1-ways-of-creating-a-series"><a href="#2-1-ways-of-creating-a-series" class="headerlink" title="2.1 ways of creating a series"></a>2.1 ways of creating a series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="comment">##creating a series from an array</span></div><div class="line">obj = pd.Series[(<span class="number">4</span>,<span class="number">7</span>,<span class="number">-5</span>,<span class="number">3</span>)]</div><div class="line">obj.values</div><div class="line">obj.index</div><div class="line"></div><div class="line">obj2=pd.Series([<span class="number">4</span>,<span class="number">7</span>,<span class="number">-5</span>,<span class="number">3</span>],index=[<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>])</div><div class="line">obj2[<span class="string">'a'</span>]  <span class="comment">##-5</span></div><div class="line">obj2[<span class="string">'d'</span>]=<span class="number">6</span></div><div class="line"></div><div class="line"><span class="comment">#filtering,or applying math functions</span></div><div class="line">obj2[obj2&gt;<span class="number">0</span>]</div><div class="line">np.exp(obj2)</div><div class="line"></div><div class="line"><span class="comment">#Plotting a series</span></div><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line">data=np.random.randn(<span class="number">5</span>)</div><div class="line">my_series=pd.Series(data,index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>])</div><div class="line">my_series.plot()</div><div class="line"></div><div class="line"><span class="comment">#create a series with an automatic index</span></div><div class="line">datan=np.random.randn(<span class="number">10</span>)</div><div class="line">pd.Series(datan)</div><div class="line"></div><div class="line"><span class="comment">#create a series from a dictionary</span></div><div class="line">sdata=&#123;<span class="string">'ohio'</span>:<span class="number">35000</span>,<span class="string">'Texas'</span>:<span class="number">71000</span>,<span class="string">'Oregon'</span>:<span class="number">16000</span>,<span class="string">'Utah'</span>:<span class="number">5000</span>&#125;</div><div class="line">obj3=pd.Series(sdata)</div><div class="line">obj3</div></pre></td></tr></table></figure>
<h2 id="2-2-Time-Series"><a href="#2-2-Time-Series" class="headerlink" title="2.2 Time Series"></a>2.2 Time Series</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">dates=pd.date_range(<span class="string">'1/1/2000'</span>,periods=<span class="number">5</span>)</div><div class="line"></div><div class="line">data=np.random.randn(<span class="number">5</span>)</div><div class="line">data=data*<span class="number">10</span></div><div class="line">time_series=pd.Series(data,index=dates)</div><div class="line"></div><div class="line">ax=time_series.plot()</div></pre></td></tr></table></figure>
<h2 id="3-data-frame"><a href="#3-data-frame" class="headerlink" title="3 data frame"></a>3 data frame</h2><ul>
<li>A tabular spreadsheet like data structure containing an ordered collection of columns</li>
<li>a data frame has multiple columns , and each can contain a different type of value</li>
<li>it has an index that provides a label for each and every row</li>
<li>many method to create : dict of arrays, dicts of lists, dict of dict, dict of series, 2-dimensional array, a single series, another dataframe.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##common way, using a dictionary of equal length lists</span></div><div class="line">data=&#123;<span class="string">'state'</span>:[<span class="string">'Ohio'</span>,<span class="string">'Ohio'</span>,<span class="string">'Ohio'</span>,<span class="string">'Neveda'</span>,<span class="string">'Neveda'</span>],<span class="string">'year'</span>:[<span class="number">2000</span>,<span class="number">2001</span>,<span class="number">2002</span>,<span class="number">2001</span>,<span class="number">2002</span>],<span class="string">'pop'</span>:[<span class="number">1.5</span>,<span class="number">1.7</span>,<span class="number">3.6</span>,<span class="number">2.4</span>,<span class="number">2.9</span>]&#125;</div><div class="line">frame=pd.DataFrame(data)</div><div class="line"></div><div class="line"><span class="comment">##an order of columns can be sepecified</span></div><div class="line">pd.DataFrame(data,columns=[<span class="string">'year'</span>,<span class="string">'state'</span>,<span class="string">'pop'</span>])</div><div class="line"><span class="comment">##pass a column that is not populated, then NaN will be assigned</span></div><div class="line">frame2=pd.DataFrame(data,columns=[<span class="string">'year'</span>,<span class="string">'state'</span>,<span class="string">'pop'</span>,<span class="string">'debt'</span>],index=[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>,<span class="string">'five'</span>])</div><div class="line"></div><div class="line"><span class="comment">#Retrieving a column</span></div><div class="line">data frames can be sliced <span class="keyword">and</span> when we retrieve a single column this a series</div><div class="line">frame2[<span class="string">'state'</span>]</div><div class="line">frame.year</div><div class="line"></div><div class="line"><span class="comment">##Retrieving a specific cell</span></div><div class="line">frame2[<span class="string">'state'</span>][<span class="string">'two'</span>]</div><div class="line">frame2.state.two</div><div class="line">frame2[[<span class="string">'state'</span>,<span class="string">'year'</span>]]</div><div class="line"></div><div class="line"><span class="comment">##Assigning values to an existing column of a data frame</span></div><div class="line">frame2[<span class="string">'debt'</span>]=<span class="number">16.5</span></div><div class="line">frame2[<span class="string">'eastern'</span>]=frame2.state==<span class="string">'Ohio'</span></div><div class="line"></div><div class="line"><span class="comment">##populating a data frame from a nested dict of dicts</span></div><div class="line">pop=&#123;<span class="string">'Nevada'</span>:&#123;<span class="number">2001</span>:<span class="number">2.4</span>,<span class="number">2002</span>:<span class="number">2.9</span>&#125;,<span class="string">'Ohio'</span>:&#123;<span class="number">2000</span>:<span class="number">1.5</span>,<span class="number">2001</span>:<span class="number">1.7</span>,<span class="number">2002</span>:<span class="number">3.6</span>&#125;&#125;</div><div class="line">frame3=pd.DataFrame(pop)</div></pre></td></tr></table></figure>
<h2 id="interacting-with-dataframes-and-series"><a href="#interacting-with-dataframes-and-series" class="headerlink" title="interacting with dataframes and series"></a>interacting with dataframes and series</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##droping entrie from an axis</span></div><div class="line">obj = pd.Series(np.arange(<span class="number">5.</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</div><div class="line">new_obj=obj.drop(<span class="string">'c'</span>)</div><div class="line"></div><div class="line"><span class="comment">##droping columns or rows from a data frame</span></div><div class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</div><div class="line">index=[<span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>, <span class="string">'Utah'</span>, <span class="string">'New York'</span>],</div><div class="line">columns=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>])</div><div class="line">data  </div><div class="line"><span class="comment">## efficiency: np.arrange(16).reshape((4,4))</span></div><div class="line">data.drop([<span class="string">'Colorado'</span>,<span class="string">'ohio'</span>])</div><div class="line">data.drop([<span class="string">'two'</span>,<span class="string">'four'</span>],axis=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="comment">## arithmetic between series</span></div><div class="line">s1 = pd.Series([<span class="number">7.3</span>, <span class="number">-2.5</span>, <span class="number">3.4</span>, <span class="number">1.5</span>], index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</div><div class="line">s2 = pd.Series([<span class="number">-2.1</span>, <span class="number">3.6</span>, <span class="number">-1.5</span>, <span class="number">4</span>, <span class="number">3.1</span>], index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>])</div><div class="line">s1 + s2</div><div class="line"></div><div class="line">df1=pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)), columns=list(<span class="string">'abcd'</span>))</div><div class="line">df2=pd.DataFrame(np.arange(<span class="number">20.</span>).reshape((<span class="number">4</span>, <span class="number">5</span>)), columns=list(<span class="string">'abcde'</span>))</div><div class="line">df1+df2  <span class="comment">#NAN</span></div><div class="line">af1.add(ad2,fill_value=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<h2 id="function-application"><a href="#function-application" class="headerlink" title="function application"></a>function application</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Numpy ufuncs---work fine with pandas objects too</span></div><div class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">3</span>),columns=list(<span class="string">'bde'</span>),index=[<span class="string">'Utah'</span>,<span class="string">'Ohio'</span>,<span class="string">'Texas'</span>,<span class="string">'Oregon'</span>])</div><div class="line">np.mean(frame,axis=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="comment">#Sorting and Ranking</span></div><div class="line"><span class="comment">##sort lexicographically</span></div><div class="line"><span class="comment">##for a series</span></div><div class="line">obj=pd.Series(range(<span class="number">4</span>),index=[<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</div><div class="line">obj.sort_index()</div><div class="line"><span class="comment">##for a dataframe</span></div><div class="line">frame=pd.DataFrame(np.arrange(<span class="number">8</span>).reshape((<span class="number">2</span>,<span class="number">4</span>)),index=[<span class="string">'three'</span>,<span class="string">'one'</span>],columns=[<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</div><div class="line">frame.sort_index(axis=<span class="number">1</span>)</div><div class="line">frame.sort_index(axis=<span class="number">1</span>,ascending=<span class="keyword">False</span>)</div><div class="line"><span class="comment">##sorting a dataframe by multiple colums</span></div><div class="line">frame=pd.DataFrame(&#123;<span class="string">'b'</span>:[<span class="number">4</span>,<span class="number">7</span>,<span class="number">-3</span>,<span class="number">2</span>],<span class="string">'a'</span>:[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>]&#125;)</div><div class="line">frame.sort_values(by=[<span class="string">'a'</span>,<span class="string">'b'</span>])</div><div class="line"></div><div class="line"><span class="comment">##Ranking</span></div><div class="line">obj=pd.Series([<span class="number">7</span>,<span class="number">-5</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">4</span>])</div><div class="line">obj.rank()</div></pre></td></tr></table></figure>
<h2 id="summary-and-descriptive-statistics"><a href="#summary-and-descriptive-statistics" class="headerlink" title="summary and descriptive statistics"></a>summary and descriptive statistics</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">df.sum(axis=0)</div><div class="line">df.describe()</div><div class="line">uniques=obj.unique</div><div class="line">obj.values_counts()</div></pre></td></tr></table></figure>
<h2 id="Handling-Missing-Data"><a href="#Handling-Missing-Data" class="headerlink" title="Handling Missing Data"></a>Handling Missing Data</h2><ul>
<li><p>filtering out missing data</p>
</li>
<li><p>filling in missing data</p>
<p>pandas aims to make working with missing data as painless as possible ——— pandas uses the floating value NaN( Not a Number) to represent missing data</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">string_data = pd.Series([<span class="string">'aardvark'</span>,<span class="string">'artichoke'</span>,np.nan,<span class="string">'avocado'</span>])</div><div class="line">string_data.isnull()</div><div class="line"></div><div class="line"><span class="comment">##filtering out missing data</span></div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> nan <span class="keyword">as</span> NA</div><div class="line">data = pd.Series([<span class="number">1</span>,NA,<span class="number">3.5</span>,NA,<span class="number">7</span>])</div><div class="line">data.dropna()</div><div class="line"><span class="comment">#or</span></div><div class="line">data[data.notnull()]</div><div class="line"></div><div class="line"><span class="comment">#with dataframes there are more options</span></div><div class="line"><span class="comment">#drop rows or columns which are all NA</span></div><div class="line"><span class="comment">#drop just those containing any NAs</span></div><div class="line"><span class="comment">#dropna by default drops any row containing a missing value</span></div><div class="line">data = pd.DataFrame([[<span class="number">1.</span>, <span class="number">6.5</span>, <span class="number">3.</span>], [<span class="number">1.</span>, NA, NA]</div><div class="line">,[NA, NA, NA], [NA, <span class="number">6.5</span>, <span class="number">3.</span>]])</div><div class="line">cleaned=data.dropna()</div><div class="line">data.dropna(how=<span class="string">'all'</span>) <span class="comment"># only drop rows that are all NA</span></div><div class="line">data.dropna(axis=<span class="number">1</span>,how=<span class="string">'all'</span>)<span class="comment"># only dropping columns that are all NA</span></div><div class="line"></div><div class="line"><span class="comment">#filling in missing data</span></div><div class="line">df=pd.DataFrame(np.random.randn(<span class="number">7</span>,<span class="number">3</span>))</div><div class="line">df.ix[:<span class="number">4</span>,<span class="number">1</span>]= NA; df.ix[:<span class="number">2</span>,<span class="number">2</span>]=NA <span class="comment">#replacing some cells with NA</span></div><div class="line">df.fillna(<span class="number">0</span>)</div><div class="line">df.fillna(&#123;<span class="number">1</span>:<span class="number">0.5</span>,<span class="number">3</span>:<span class="number">-1</span>&#125;) <span class="comment"># fill columns which contain NA</span></div></pre></td></tr></table></figure>
<h2 id="another-way-to-index"><a href="#another-way-to-index" class="headerlink" title="another way to index"></a>another way to index</h2><p>using conditions to access specific rows and columns of a data frame then the following can be of use :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">col1 col2 col3 col4</div><div class="line">0 a 4.0 7.0 NaN</div><div class="line">1 b 8.1 3.0 1.0</div><div class="line">2 a 7.0 0.0 3.0</div><div class="line">3 NaN NaN NaN NaN</div><div class="line">4 c 3.0 4.0 5.0</div><div class="line"></div><div class="line">df.loc[row_index,col_index]</div><div class="line">df.loc[df.index[0],&apos;co11&apos;]</div><div class="line">df.loc[df.index[0],&apos;coll&apos;]=&apos;ab&apos;</div></pre></td></tr></table></figure>
<h2 id="hierarchical-indexing"><a href="#hierarchical-indexing" class="headerlink" title="hierarchical indexing"></a>hierarchical indexing</h2><ul>
<li>multiple index levels on one axis</li>
<li>useful in forming data summaries similiar to pivot tables</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##hierarchical indexing in series</span></div><div class="line">data = pd.Series(np.random.randn(<span class="number">10</span>),</div><div class="line">index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'d'</span>],</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]])</div><div class="line">data</div><div class="line"></div><div class="line">a <span class="number">1</span> <span class="number">-0.471281</span></div><div class="line">  <span class="number">2</span> <span class="number">-1.203460</span></div><div class="line">  <span class="number">3</span> <span class="number">-1.621591</span></div><div class="line">b <span class="number">1</span> <span class="number">-0.347538</span></div><div class="line">  <span class="number">2</span> <span class="number">0.775034</span></div><div class="line">  <span class="number">3</span> <span class="number">-0.780596</span></div><div class="line">c <span class="number">1</span> <span class="number">0.949629</span></div><div class="line">  <span class="number">2</span> <span class="number">0.627248</span></div><div class="line">d <span class="number">2</span> <span class="number">-1.591168</span></div><div class="line">  <span class="number">3</span> <span class="number">0.623742</span></div><div class="line">dtype: float64</div><div class="line"></div><div class="line">data[<span class="string">'b'</span>]</div><div class="line">data[:,<span class="number">2</span>]</div><div class="line"></div><div class="line"><span class="comment">##could be rearranged into a dataframe</span></div><div class="line">data.unstack() ----</div><div class="line">     <span class="number">1</span>      <span class="number">2</span>      <span class="number">3</span></div><div class="line">a <span class="number">-0.471281</span> <span class="number">-1.203460</span> <span class="number">-1.621591</span></div><div class="line">b <span class="number">-0.347538</span> <span class="number">0.775034</span> <span class="number">-0.780596</span></div><div class="line">c <span class="number">0.949629</span> <span class="number">0.627248</span> NaN</div><div class="line">d NaN <span class="number">-1.591168</span> <span class="number">0.623742</span></div><div class="line"></div><div class="line">data.unstack().stack()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hierarchical indexing in dataframes</span></div><div class="line">frame = pd.DataFrame(np.arange(<span class="number">12</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]],</div><div class="line">columns=[[<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>],[<span class="string">'Green'</span>, <span class="string">'Red'</span>, <span class="string">'Green'</span>]])</div><div class="line"></div><div class="line"><span class="comment">#assign names to the indexes: (a.b) and (1,2)</span></div><div class="line">frame.index.names=[<span class="string">'key1'</span>,<span class="string">'key2'</span>]</div><div class="line">frame.columns.names=[<span class="string">'state'</span>,<span class="string">'color'</span>]</div><div class="line"></div><div class="line">frame[<span class="string">'Colorado'</span>]</div><div class="line"></div><div class="line">frame.swaplevel(<span class="string">'key1'</span>,<span class="string">'key2'</span>)</div><div class="line"></div><div class="line"><span class="comment">##summary statistics by level</span></div><div class="line">frame.sum(level=<span class="string">'key2'</span>)</div><div class="line"></div><div class="line"><span class="comment">##using data frame colums</span></div><div class="line">frame = pd.DataFrame(&#123;<span class="string">'a'</span>: range(<span class="number">7</span>), <span class="string">'b'</span>: range(<span class="number">7</span>, <span class="number">0</span>, <span class="number">-1</span>),<span class="string">'c'</span>: [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>],<span class="string">'d'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]&#125;)</div><div class="line"></div><div class="line">frame2=frame.set_index([<span class="string">'c'</span>,<span class="string">'d'</span>])</div><div class="line">frame2.reset_index()</div></pre></td></tr></table></figure>
<h2 id="handling-data-with-pandas"><a href="#handling-data-with-pandas" class="headerlink" title="handling data with pandas"></a>handling data with pandas</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">df=pd.read_csv(<span class="string">'fuel.csv'</span>)</div><div class="line">df.head()</div><div class="line"></div><div class="line">df=pd.read_csv(<span class="string">'fuel.csv'</span>, header=<span class="keyword">None</span>, names=[<span class="string">'MPG'</span>, <span class="string">'GPM'</span>, <span class="string">'WT'</span>, <span class="string">'DIS'</span>, <span class="string">'NC'</span>, <span class="string">'HP'</span>, <span class="string">'ACC'</span>, <span class="string">'ET'</span>])</div><div class="line">df.head()</div><div class="line"></div><div class="line"><span class="comment">##writing out data with pandas</span></div><div class="line">Data can be exported to delimited format:</div><div class="line">• data.to_csv(‘out.csv’)</div><div class="line">• Other options are available: index=<span class="keyword">False</span>, header=<span class="keyword">False</span></div><div class="line">It <span class="keyword">is</span> also possible to: - Read text files <span class="keyword">in</span> pieces - JSON data - XML <span class="keyword">and</span> Webscraping - Binary</div><div class="line">data formats - Excel files</div></pre></td></tr></table></figure>
<h2 id="interacting-with-databases"><a href="#interacting-with-databases" class="headerlink" title="interacting with databases"></a>interacting with databases</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Here is a template of code to work with mySQL</span></div><div class="line"><span class="comment">#import MySQLdb as mdb</span></div><div class="line"><span class="comment">#import pandas.io.sql as sql</span></div><div class="line"><span class="comment">#from pandas import *</span></div><div class="line"><span class="comment">#conn = mdb.connect('&lt;server&gt;','&lt;user&gt;','&lt;pass&gt;','&lt;db&gt;');</span></div><div class="line"><span class="comment">#df = sql.read_frame('&lt;query&gt;', conn)</span></div></pre></td></tr></table></figure>
<h2 id="clean-transform-merge-and-reshape"><a href="#clean-transform-merge-and-reshape" class="headerlink" title="clean, transform, merge and reshape"></a>clean, transform, merge and reshape</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">df1=pd.DataFrame([[<span class="string">'Bob'</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>],[<span class="string">'Sam'</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">9</span>],</div><div class="line">[<span class="string">'Betty'</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>], [<span class="string">'Val'</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">9</span>]], columns=[<span class="string">'name'</span>, <span class="string">'math'</span>,<span class="string">'literacy'</span>,<span class="string">'reading'</span>])</div><div class="line">df2=pd.DataFrame([[<span class="string">'Bob'</span>,<span class="number">10</span>,<span class="number">8</span>],[<span class="string">'Sandy'</span>,<span class="number">7</span>,<span class="number">8</span>],[<span class="string">'Molly'</span>,<span class="number">6</span>,<span class="number">8</span>]], columns=[<span class="string">'name'</span>,<span class="string">'science'</span>,<span class="string">'history'</span>])</div><div class="line"></div><div class="line"><span class="comment">#inner join</span></div><div class="line">pd.merge(df1,df2,on=<span class="string">'name'</span>)</div><div class="line"><span class="comment"># other join</span></div><div class="line">pd.merge(df1,df2,on=<span class="string">'name'</span>,how=<span class="string">'outer'</span>)</div><div class="line"><span class="comment"># right join</span></div><div class="line">pd.merge(df1,df2,on=<span class="string">'name'</span>,how=<span class="string">'right'</span>)</div><div class="line"></div><div class="line"><span class="comment">##merging on the index</span></div><div class="line">left1 = pd.DataFrame(&#123;<span class="string">'key'</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>],<span class="string">'value'</span>: range(<span class="number">6</span>)&#125;)</div><div class="line">right1 = pd.DataFrame(&#123;<span class="string">'group_val'</span>: [<span class="number">3.5</span>, <span class="number">7</span>]&#125;, index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</div><div class="line">pd.merge(left1, right1, left_on=<span class="string">'key'</span>, right_index=<span class="keyword">True</span>)</div><div class="line"></div><div class="line"><span class="comment">##concatenating</span></div><div class="line">s1=pd.Series([<span class="number">0</span>,<span class="number">1</span>], index=[<span class="string">'a'</span>,<span class="string">'b'</span>])</div><div class="line">s2=pd.Series([<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], index=[<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>])</div><div class="line">s3=pd.Series([<span class="number">5</span>,<span class="number">6</span>], index=[<span class="string">'f'</span>,<span class="string">'g'</span>])</div><div class="line">s3</div><div class="line">pd.concat([s1,s2,s3])</div><div class="line">pd.concat([s1,s2,s3],axis=<span class="number">1</span>)</div><div class="line"><span class="comment">##concatenating dataframes</span></div><div class="line">df1=pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>]], index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>],columns=[<span class="string">'one'</span>,<span class="string">'two'</span>])</div><div class="line">df1</div><div class="line">df2=pd.DataFrame([[<span class="number">7</span>,<span class="number">8</span>],[<span class="number">9</span>,<span class="number">10</span>]], index=[<span class="string">'a'</span>,<span class="string">'c'</span>],</div><div class="line">columns=[<span class="string">'three'</span>,<span class="string">'four'</span>])</div><div class="line">df2</div><div class="line">pd.concat([df1,df2], axis=<span class="number">1</span>)</div><div class="line"><span class="comment">#specific keys can be specified.</span></div><div class="line">pd.concat([df1,df2], axis=<span class="number">1</span>, keys=[<span class="string">'level1'</span>,<span class="string">'level2'</span>])</div><div class="line"></div><div class="line"><span class="comment">##combining data</span></div><div class="line"><span class="comment">## useful in cases where there may be same missing</span></div><div class="line">df1=pd.DataFrame([[<span class="number">7</span>,<span class="number">8</span>],[<span class="number">9</span>,np.nan]])</div><div class="line">df2=pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])</div><div class="line">df1.combine_first(df2)</div><div class="line"></div><div class="line"><span class="comment">##remove duplicates</span></div><div class="line">df.drop_duplicates()</div><div class="line"></div><div class="line"><span class="comment">##replacing values</span></div><div class="line">data=pd.Series([<span class="number">2</span>,<span class="number">3</span>,<span class="number">-999</span>,<span class="number">2</span>,<span class="number">-888</span>])</div><div class="line">data.replace([<span class="number">-999</span>,<span class="number">-888</span>],[np.nan, <span class="number">0</span>])</div><div class="line"></div><div class="line"><span class="comment">## Detecting and Filtering outliers</span></div><div class="line">rdata=pd.DataFrame(np.random.randn(<span class="number">1000</span>,<span class="number">4</span>))</div><div class="line">rdata.describe()</div><div class="line">rdata[(np.abs(rdata)&gt;<span class="number">3</span>).any(<span class="number">1</span>)]</div></pre></td></tr></table></figure>
<h2 id="some-plot"><a href="#some-plot" class="headerlink" title="some plot"></a>some plot</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">df.plot</div><div class="line">df.plot(king=<span class="string">'bar'</span>)c</div><div class="line">df.boxplot()</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://fanyaoxin.com/2016/11/22/python基础-pandas/" data-id="cizdwvuqa000n9ikgay8mmh4x" class="article-share-link">Aktie</a><div class="tags"><a href="/tags/python/">python</a></div><div class="post-nav"><a href="/2017/01/04/pandas/" class="pre">pandas</a><a href="/2016/11/10/python基础-numpy/" class="next">python基础-numpy</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://fanyaoxin.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Kategorien</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/pattern-recognition/" style="font-size: 15px;">pattern recognition</a> <a href="/tags/database/" style="font-size: 15px;">database</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/数据分析/" style="font-size: 15px;">数据分析</a> <a href="/tags/可视化/" style="font-size: 15px;">可视化</a> <a href="/tags/强化学习/" style="font-size: 15px;">强化学习</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/AI/" style="font-size: 15px;">AI</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/文本处理/" style="font-size: 15px;">文本处理</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/19/向量机/">向量机</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/19/openAI-探索/">openAI 探索</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/神经网络/">神经网络</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/09/机器学习课程大纲/">机器学习课程大纲</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/机器学习笔记（一）/">机器学习笔记（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/05/noSQL/">noSQL</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/04/pandas/">pandas</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/python基础-pandas/">python基础-pandas</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/python基础-numpy/">python基础-numpy</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/python基础-3/">python基础(3)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Fan Yaoxin.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>